<div class="table-responsive">
    <table id="alarmsTable" class="table table-striped table-hover">
        <thead>
            <tr>
                <th>Site ID</th>
                <th>Site Name</th>
                <th>Description</th>
                <th>Category</th>
                <th>Priority</th>
                <th>Status</th>
                <th>Created</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for alarm in alarms %}
                <tr>
                    <td>{{ alarm.site.site_id }}</td>
                    <td>{{ alarm.site.name }}</td>
                    <td>
                        <div class="text-truncate" style="max-width: 250px;" 
                             data-bs-toggle="tooltip" title="{{ alarm.description }}">
                            {{ alarm.description }}
                        </div>
                    </td>
                    <td>
                        <span class="badge bg-secondary">
                            {{ alarm.category.replace('_', ' ') }}
                        </span>
                    </td>
                    <td>
                        {% if alarm.priority_score > 10 %}
                            <span class="badge bg-danger">High ({{ alarm.priority_score }})</span>
                        {% elif alarm.priority_score > 5 %}
                            <span class="badge bg-warning text-dark">Medium ({{ alarm.priority_score }})</span>
                        {% else %}
                            <span class="badge bg-info">Low ({{ alarm.priority_score }})</span>
                        {% endif %}
                    </td>
                    <td>
                        <span class="badge bg-{{ alarm.status.lower() }}">
                            {{ alarm.status.replace('_', ' ') }}
                        </span>
                    </td>
                    <td>{{ alarm.created_at_jakarta.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td>
                        <div class="btn-group">
                            <a href="{{ url_for('alarms.view_alarm', alarm_id=alarm.id) }}" 
                               class="btn btn-sm btn-outline-primary" title="View Details">
                                <i class="fas fa-eye"></i>
                            </a>
                            
                            {% if alarm.status.value in ['OPEN', 'ACKNOWLEDGED'] %}
                                <a href="{{ url_for('alarms.add_remark', alarm_id=alarm.id) }}" 
                                   class="btn btn-sm btn-outline-warning" title="Add Remark">
                                    <i class="fas fa-comment"></i>
                                </a>
                            {% endif %}
                            
                            {% if alarm.status.value not in ['RESOLVED', 'CLOSED'] %}
                                <button class="btn btn-sm btn-outline-success resolve-alarm" 
                                        data-alarm-id="{{ alarm.id }}" title="Resolve">
                                    <i class="fas fa-check"></i>
                                </button>
                            {% endif %}
                            
                            {% if current_user.role == 'tsel' and alarm.status.value == 'RESOLVED' %}
                                <button class="btn btn-sm btn-outline-secondary close-alarm" 
                                        data-alarm-id="{{ alarm.id }}" title="Close">
                                    <i class="fas fa-lock"></i>
                                </button>
                            {% endif %}
                            
                            {% if current_user.role == 'tsel' %}
                                <button class="btn btn-sm btn-outline-danger delete-alarm" 
                                        data-alarm-id="{{ alarm.id }}" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            {% endif %}
                        </div>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div> 